---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import ProjectLinkIcons from './ProjectLinkIcons.astro';

interface Props {
  project: CollectionEntry<'projects'>;
  index: number;
}

const { project, index } = Astro.props;
const { title, description, coverImage, tags, links } = project.data;
const isPortrait = coverImage.width < coverImage.height;
---

<article
  class="project-card group flex flex-col overflow-hidden rounded-xl border border-zinc-200 bg-white shadow-sm transition-shadow hover:shadow-md dark:border-zinc-800 dark:bg-zinc-900"
  data-tags={JSON.stringify(tags)}
  style={`animation-delay: ${index * 80}ms`}
>
  <a href={`/projects/${project.id}`} class="overflow-hidden">
    {isPortrait ? (
      <div class="aspect-[1.91/1] flex items-center justify-center bg-zinc-100 dark:bg-zinc-800">
        <Image
          src={coverImage}
          alt={title}
          height={315}
          class="h-full w-auto object-contain transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
        />
      </div>
    ) : (
      <Image
        src={coverImage}
        alt={title}
        width={600}
        height={315}
        class="aspect-[1.91/1] w-full object-cover transition-transform duration-300 group-hover:scale-105"
        loading="lazy"
      />
    )}
  </a>
  <div class="flex flex-1 flex-col p-5">
    <h3 class="text-lg font-semibold text-zinc-900 dark:text-zinc-100">
      <a href={`/projects/${project.id}`} class="hover:text-accent-600 dark:hover:text-accent-400">
        {title}
      </a>
    </h3>
    <p class="mt-2 line-clamp-2 flex-1 text-sm text-zinc-600 dark:text-zinc-400">
      {description}
    </p>
    <div class="mt-4 flex items-center justify-between gap-2">
      <div class="flex flex-wrap gap-2">
        {tags.slice(0, 3).map((tag) => (
          <span class="rounded-full bg-accent-50 px-2.5 py-0.5 text-xs font-medium text-accent-700 dark:bg-accent-950 dark:text-accent-300">
            {tag}
          </span>
        ))}
      </div>
      {links.length > 0 && <ProjectLinkIcons links={links} />}
    </div>
  </div>
</article>
